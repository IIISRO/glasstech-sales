{% load static %}
{% load customers_tags %}
{% CustomersList as customers %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  {% block title %}{% endblock %}
  
  <link rel="icon" href="{% static 'img/glasstechadmin.png' %}" type="image/x-icon">
  <link rel="shortcut icon" href="{% static 'img/glasstechadmin.png' %}" type="image/x-icon">

  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="{% static 'plugins/fontawesome-free/css/all.min.css' %}">
  <!-- IonIcons -->
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="{% static 'css/adminlte.min.css' %}">

  <style>
    .activate:hover{
      cursor: pointer;
    }
    @keyframes slideInFromDown {
      0% {
        transform: translateY(-100%);
      }
      100% {
        transform: translateY(0);
      }
    }

    #message {  
      /* This section calls the slideInFromLeft animation we defined above */
      animation: 1s ease-out 0s 1 slideInFromDown;
      
    }

  </style>
  <script>
    function userPPAlt(event){
      event.target.src = "{% static 'img/default_user_pp.jpg' %}"
    }
  </script>
  {% block style %}
  
  {% endblock style %}

</head>
<!--
`body` tag options:

  Apply one or more of the following classes to to the body tag
  to get the desired effect

  * sidebar-collapse
  * sidebar-mini
-->
<body class="hold-transition sidebar-mini">
<div class="wrapper">
  <!-- Navbar -->
  <nav class="main-header navbar navbar-expand navbar-white navbar-light">
    <!-- Left navbar links -->
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="{% url 'core:dashboard' %}" class="nav-link">Dashboard</a>
      </li>
   
    </ul>

    <!-- Right navbar links -->
    <ul class="navbar-nav ml-auto">
      <!-- Navbar Search -->
      <!-- <li class="nav-item">
        <a class="nav-link" data-widget="navbar-search" href="#" role="button">
          <i class="fas fa-search"></i>
        </a>
        <div class="navbar-search-block">
          <form class="form-inline">
            <div class="input-group input-group-sm">
              <input class="form-control form-control-navbar" type="search" placeholder="Search" aria-label="Search">
              <div class="input-group-append">
                <button class="btn btn-navbar" type="submit">
                  <i class="fas fa-search"></i>
                </button>
                <button class="btn btn-navbar" type="button" data-widget="navbar-search">
                  <i class="fas fa-times"></i>
                </button>
              </div>
            </div>
          </form>
        </div>
      </li> -->

      <!-- Messages Dropdown Menu -->
      <!-- <li class="nav-item dropdown">
        <a class="nav-link" data-toggle="dropdown" href="#">
          <i class="far fa-comments"></i>
          <span class="badge badge-danger navbar-badge">3</span>
        </a>
        <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
          <a href="#" class="dropdown-item">
            <div class="media">
              <img src="" alt="UserIMG" onerror="userPPAlt(event)" class="img-size-50 mr-3 img-circle">
              <div class="media-body">
                <h3 class="dropdown-item-title">
                  Brad Diesel
                  <span class="float-right text-sm text-danger"><i class="fas fa-star"></i></span>
                </h3>
                <p class="text-sm">Call me whenever you can...</p>
                <p class="text-sm text-muted"><i class="far fa-clock mr-1"></i> 4 Hours Ago</p>
              </div>
            </div>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <div class="media">
              <img src="" onerror="userPPAlt(event)" alt="User Avatar" class="img-size-50 img-circle mr-3">
              <div class="media-body">
                <h3 class="dropdown-item-title">
                  John Pierce
                  <span class="float-right text-sm text-muted"><i class="fas fa-star"></i></span>
                </h3>
                <p class="text-sm">I got your message bro</p>
                <p class="text-sm text-muted"><i class="far fa-clock mr-1"></i> 4 Hours Ago</p>
              </div>
            </div>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <div class="media">
              <img src="" onerror="userPPAlt(event)" alt="User Avatar" class="img-size-50 img-circle mr-3">
              <div class="media-body">
                <h3 class="dropdown-item-title">
                  Nora Silvester
                  <span class="float-right text-sm text-warning"><i class="fas fa-star"></i></span>
                </h3>
                <p class="text-sm">The subject goes here</p>
                <p class="text-sm text-muted"><i class="far fa-clock mr-1"></i> 4 Hours Ago</p>
              </div>
            </div>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item dropdown-footer">See All Messages</a>
        </div>
      </li> -->
      <!-- Notifications Dropdown Menu -->
      <!-- <li class="nav-item dropdown">
        <a class="nav-link" data-toggle="dropdown" href="#">
          <i class="far fa-bell"></i>
          <span class="badge badge-warning navbar-badge">15</span>
        </a>
        <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
          <span class="dropdown-item dropdown-header">15 Notifications</span>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <i class="fas fa-envelope mr-2"></i> 4 new messages
            <span class="float-right text-muted text-sm">3 mins</span>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <i class="fas fa-users mr-2"></i> 8 friend requests
            <span class="float-right text-muted text-sm">12 hours</span>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <i class="fas fa-file mr-2"></i> 3 new reports
            <span class="float-right text-muted text-sm">2 days</span>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item dropdown-footer">See All Notifications</a>
        </div>
      </li> -->
      <li class="nav-item">
        <a class="nav-link" data-widget="fullscreen" href="#" role="button">
          <i class="fas fa-expand-arrows-alt"></i>
        </a>
      </li>
      <!-- <li class="nav-item">
        <a class="nav-link" data-widget="control-sidebar" data-slide="true" href="#" role="button">
          <i class="fas fa-th-large"></i>
        </a>
      </li> -->
      <li class="nav-item">
        <a class="nav-link"  data-slide="true" href="{% url 'accounts:logout' %}" role="button">
          <i class="fas fal fa-sign-out-alt"></i>
        </a>
      </li>
    </ul>
  </nav>
  <!-- /.navbar -->
  {% if messages %}
  <ul class="messages" id="message">
      {% for message in messages %}
      <li{% if message.tags %} class="{{ message.tags }}"{% endif %} style="display:flex; justify-content: center; height: 30px; background-color: rgb(0, 132, 255); color: white; font-weight: bold; font-size: 15px; align-items: center;">{{ message }}</li>
      {% endfor %}
  </ul>
  {% endif %}
  <!-- Main Sidebar Container -->
  <aside class="main-sidebar sidebar-dark-primary elevation-4">
    <!-- Brand Logo -->
    <a href="{% url 'core:dashboard' %}" class="brand-link">
      <img src="{% static 'img/glasstechadmin.png' %}" alt="GlasstechSales Logo" class="brand-image elevation-3" style="opacity: .8">
      <span class="brand-text font-weight-light"><b>glasstech</b>Sales</span>
    </a>

    <!-- Sidebar -->
    <div class="sidebar">
      <!-- Sidebar user panel (optional) -->
      <div class="user-panel mt-3 pb-3 mb-3 d-flex">
        <div class="image">
          <img src="{% if request.user.pp %}{{request.user.pp.url}}{% else %}{% endif %}" class="img-circle elevation-2" alt="UserIMG" onerror="userPPAlt(event)">
        </div>
        <div class="info">
          <a href="#" class="d-block">{{request.user.get_full_name}}</a>
        </div>
      </div>

      <!-- SidebarSearch Form -->
      <div class="form-inline">
        <div class="input-group" data-widget="sidebar-search">
          <input class="form-control form-control-sidebar" type="search" placeholder="Search" aria-label="Search">
          <div class="input-group-append">
            <button class="btn btn-sidebar">
              <i class="fas fa-search fa-fw"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- Sidebar Menu -->
      <nav class="mt-2">
        <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
          <!-- Add icons to the links using the .nav-icon class
               with font-awesome or any other icon font library -->



          <li class="nav-item">
            <a href="{% url 'core:dashboard' %}" {% if request.path == '/' %} class="nav-link active"  {% else %} class="nav-link" {% endif %}>
                <i class="nav-icon fas fa-tachometer-alt"></i>
              <p>
                Dashboard
              </p>
            </a>
          </li>
          <li class="nav-header">Müştəri</li>
          <li class="nav-item">
            <a href="{% url 'customers:create-customer' %}" {% if request.path == '/customers/create/customer' %} class="nav-link active"  {% else %} class="nav-link" {% endif %}>
              <i class="nav-icon fa-solid fas fa-user-plus"></i>
                <p>
                  Müştəri qeydiyyatı
                </p> 
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'customers:customers-list' %}" {% if request.path == '/customers/list' %} class="nav-link active"  {% else %} class="nav-link" {% endif %}>
              <i class="nav-icon fas fa-solid fa-users"></i>
                <p>
                  Müştəri siyahısı
                </p> 
            </a>
          </li>
          <li class="nav-header">Satış</li>
          <li class="nav-item">
            <a onclick="addActiveClass(event)" data-toggle="modal" id="customerCreateButton" data-target="#customerCreate" class="activate nav-link">
              <i class="nav-icon fas fa-solid fa-file"></i>
                <p>
                  Yeni Təklif Yarat
                </p>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'sales:offers-list' %}" {% if request.path == '/sales/offers' %} class="nav-link active"  {% else %} class="nav-link" {% endif %}>
              <i class="nav-icon fas fa-solid fa-file-invoice"></i>
                <p>
                  Təklif siyahısı
                </p> 
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'sales:orders-list' %}" {% if request.path == '/sales/orders' %} class="nav-link active"  {% else %} class="nav-link" {% endif %}>
              <i class="nav-icon fas fa-solid fa-file-signature"></i><p>
                  Sifariş siyahısı
                </p> 
            </a>
          </li>
          <li class="nav-header">Məhsul</li>
          <li class="nav-item">
            <a href="{% url 'products:create_product' %}" {% if request.path == '/products/create/product' %} class="nav-link active"  {% else %} class="nav-link" {% endif %}>
              <i class="nav-icon fas fa-solid fa-dolly"></i>
                <p>
                  Məhsul qeydiyyatı
                </p> 
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'products:list_sales_product' %}" {% if request.path == '/products/sales/list' %} class="nav-link active"  {% else %} class="nav-link" {% endif %}>
              <i class="fas nav-icon fa-solid fa-cart-arrow-down"></i>
                <p>
                  Məhsul Satışları
                </p> 
            </a>
          </li>
          <li  class="d-none nav-header">Personal</li>
          <li class="d-none nav-item">
            <a href="{% url 'accounts:register' %}" {% if request.path == '/accounts/register' %} class="nav-link active"  {% else %} class="nav-link" {% endif %}>
              <i class="nav-icon fas fa-solid fa-dolly"></i>
                <p>
                  Personal qeydiyyatı
                </p> 
            </a>
          </li>
          



        </ul>
      </nav>
      <!-- /.sidebar-menu -->
    </div>
    <!-- /.sidebar -->
  </aside>
    <!-- Select User Modal -->
  <div onclick="addActiveClass(event)" data-remove_active="customerCreateButton" class="modal fade" id="customerCreate" tabindex="-1" role="dialog" aria-labelledby="customerCreateLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
         <h5 class="modal-title" id="customerCreateLabel">Yeni Təklif Yarat</h5>
         <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
         </button>
        </div>
        <div class="modal-body">
          <label>Müştəri seçin:</label>
          <select class="form-control" style="width: 100%;" name="customer" id="customer">
           <option value="" disabled selected>---------</option>
            {% for customer in customers %}
           <option value="{{customer.id}}">{{customer}}</option>
            {% endfor %}
          </select>
        </div>
        <div class="modal-footer">
         <button onclick="addActiveClass(event)" data-remove_active="customerCreateButton" type="button" class="btn btn-secondary" data-dismiss="modal">Ləğv</button>
         <button onclick="redirectaOfferCreate()" type="button" class="btn btn-primary">Davam</button>
        </div>
      </div>
    </div>
  </div>
<!-- Content Wrapper. Contains page content -->
{% block content %}

{% endblock content %}
<!-- /.content-wrapper -->

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Control sidebar content goes here -->
  </aside>
  <!-- /.control-sidebar -->

  <!-- Main Footer -->
  <footer class="main-footer">
    <strong>Copyright &copy; 2023 <a href="https://glasstech.az/az/home/">glasstechSales</a>.</strong>
    All rights reserved. <br> <b>Powered by  <a href="https://ungravity.com/">Ungravity&copy;</a></b>
    <div class="float-right d-none d-sm-inline-block">
      <b>Version</b> 1.0.0 Beta
    </div>
  </footer>
</div>
<!-- ./wrapper -->

<!-- REQUIRED SCRIPTS -->

<!-- jQuery -->
<script src="{% static 'plugins/jquery/jquery.min.js' %}"></script>
<!-- Bootstrap -->
<script src="{% static 'plugins/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
<!-- AdminLTE -->
<script src="{% static 'js/adminlte.js' %}"></script>


<script src="{% static 'js/loader.js' %}"></script>

<script>
  
 
  function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = jQuery.trim(cookies[i]);
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
  }
  function addActiveClass(event){
    if (event.target.classList.contains('activate')){
      event.target.classList.add('active')
    }else{
      document.getElementById(`${event.target.dataset.remove_active}`).classList.remove('active')
    }
  }
  function redirectaOfferCreate(){
    if(document.getElementById('customer').value){
      window.location.href = `{% url 'sales:create-offer' %}?customer=${document.getElementById('customer').value}`
    }
  }
</script>


{% block scripts %}
{% endblock scripts %}

</body>
</html>
